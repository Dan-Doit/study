# DDD (Domin Driven Design)

도메인 주도 개발에서 원하는 핵심을 정리합니다.

---



## 전략적 설계

주로 **무엇과 왜**를 담당하는 이파트는 소프트웨어 각각 구성요소가 구현되는 방법을 찾는다.



## 비지니스 도메인 분석하기



### 하위 도메인 분석하기

비지니스 도메인의 목표을 달성하기 위해 우리는 여러가지의 하위 도메인이 필요하다.

하위 도메인은 많은 세부 단위로 쪼개 질수 있다.

- **핵심 하위 도메인**
  - 회사가 경쟁업체와 다르게 수행하고 있는 것을 말한다.
  - 회사의 경쟁 우위를 제공한다.
  - 이 도메인을 따로 부업으로 전환할수 있다.
  - 복잡한 알고리즘 또는 비지니스 프로세스 규칙등에 의해 조정된다.
  - 자주 변경될수 있다.
  - 다소 흥미로운 문제를 다룬다.
- **일반 하위 도메인**
  - 모든 회사가 같은 방식으로 수행하는 비지니스 활동을 말한다.
  - 경쟁우위의 원천이 될 수 없다.
  - 복잡성이 다소 높은편이지만 참고할 선사례를 사용할수 있다.
  - 이미 해결된 문제를 다룬다.
- **지원 하위 도메인**
  - 회사의 비지니스를 지원하는 활동을 말한다.
  - 외부 솔루션을 연동하는 것보다 자체 솔루션을 구현하는 것이 간단하다.
  - 비지니스 로직이 CRUD 인터페이스와 유사하다.
  - 자주 변경되지 않는다.
  - 뻔한 문제를 다룬다.



## 도메인 지식 찾아내기

효과적인 소프트웨어 솔루션을 설계하려면 적어도 기본적인 비지니스 도메인 지식이 있어야한다.

또한 모든 소프트웨어 프로젝트에는 도메인 전문가, 프로젝트 소유자, 엔지니어, 디자이너 등 다양한 역할의 이해관계와 협업이 필요하다.

그리고 이를 위해 유비쿼터스 언어(보편적인 언어)의 사용은 매우 중요하다.

서로가 사용하는 언어의 뜻이 명확하게 전달 된다면 번역의 비용(만약 내가 말한내용을 다르게 알아듣는다면 이는 바로 더 많은 시간을 소요하게된다.)

이 절감하게 되고 의사소통의 어려움도 많은 부분에서 해소된다.

이러한 협력과 이해관계을 위해 다음을 염두해야한다.

- 일관성

  반드시 정확하고 일관성이 있어야 한다.

  가정할 필요가 없어야 하고 비지니스 도메인의 로직을 명료하게 표현해야한다.

- 모호한 언어

  소프트웨어는 모호성에 잘 대처하지 못하며, 이를 모델링 하기가 매우 어렵다.

- 동의어

  두가지 언어는 서로 바꿔서 사용할 수 없다.

  동의어는 처음에는 해로워 보이지 않지만, 대부분의 경우 다른 의미를 갖는다.

  예를들어 방문자, 계정은 비슷한 말이지만 명백히 다른 의미를 갖는다.

  이런 동의어는 후에 혼란을 야기하게된다.



### 비지니스 도메인 모델 언어

모든 모델은 목적이 있고 효과적인 모델은 그 목적을 달성하는 데 필요한 **세부사항만 포함**한다.

모델이란 복사본이 아니라 문제를 해결하려는 의도가 있고, 목적에 필요한 정보만 제공해야한다.



### 아카이브 되어있는 언어

유비쿼터스 언어를 수집하고 관리하는 언어집등을 사용할수 있다.

이런 용어집은 비지니스 도메인의 용어에 대한 정보를 얻을 수 있는 거점 역할을 하므로 새로운 팀원이 쉽게 적응하게 해준다.

용어집의 유지보수는 매우 중요하고, 변경되면 모든 팀원이 수정할 수 있게 독려해야한다.



이외에도 프로젝트를 위해 많은 것들을 활용할수 있다.

대화, 문서화, 테스트, 다이어그램, 소스코드등으로 개발하는 비지니스 도메인을 명확히 해야한다.



### 바운디드 컨텍스트

유비쿼터스 언어를 여러개의 작은 언어로 나눈다음 각 언어를 적용할 수 있는 명시적인 바운디드 컨텍스트가 들어오면 이를 사용한다.

다음을 유의하여 바운디드 컨텍스트를 정의할수 있다.

- 모델의 경계

- 수명주기

- 물리적 경계

  개별 서비스/프로젝트로 구현되어야한다.

  또한 구현, 진화, 버전 관리를 각각의 다른 바운디드 컨텍스트와 독립적으로 해야한다.

- 소유권 경계

  서로간의 독립성과 존중을 유지하는것이 필요하다.



## 패턴 



### 협력형 패턴 그룹

소통이 잘 되는 팀에서 구현된 바운디드 컨텍스트와 관련이 있다.

이 패턴이 적합한 요건은 팀의 커뮤니케이션과 협업의 수준에 있다.

- 파트너십 패턴

  바운디드 컨텍스트는 에드 혹 방식으로 연동된다.

  먼저 받아들이고 양팀은 차이점을 함께 해결하고 가장 적절한 솔루션을 선정한다.

  또한 발생할 수 있는 연동의 문제를 해결하는데 양팀 모두 협력한다.

  서로 방해하지 않는다.

  이러한 패턴은 동기화의 문제로 지리적으로 떨어진 팀에게는 적합하지 않다.

- 공유커널 패턴

  두 개 이상의 바운디드 컨텍스트가 참여하는 모든 바운디드 컨텍스트의 제한적으로 겹치는 모델을 공유해서 연동한다.

  어떤 방식이든 공유된 커널에 대한 변경이 생길때 마다 영향을 받는 모든 바운디드 컨텍스트와 연동 테스트를한다.

  여기서 공유된 커널은 조직간의 서로 같이 중복이 되는 바운디드 컨텍스트를 말한다.



### 사용자-제공자 패턴 그룹

그룹의 경우와는 다르게 사용자-제공자는 서로 독립적으로 성공할수 있다.

이는 분리되어있을 수 있고, 주도하는 쪽의 권력의 불균형이 존재한다.

- 순응주의자 패턴

  사용자는 서비스 제공자에게 순응한다.

  힘의 균형이 서비스를 제공하는 제공자에 있는경우가 있다.

  정치적 이유나 사용자의 요구를 지원할 동기가 없는 경우가 그렇다.

- 충돌방지 계층 패턴

  사용자는 서비스 제공자의 모델을 사용자의 요건에 맞게 번역한다.

  힘의 균형이 제공자에게 있지만 사용자가 사용하는 바운디드 컨텍스트가 이에 순응하지 못하는 경우가 있다.

- 오픈 호스트 서비스 패턴

  서비스 제공자는 사용자의 요건에 최적화된 모델인 공표된 언어를 구현한다.

  이 패턴은 힘이 사용자 쪽에 있을경우를 처리한다.



### 분리형 노선 패턴

전혀 협업하지 않는 패턴이다.

협력과 연동보다 특정 기능을 중복으로 두는 것이 더 저렴한 경우이다.

팀에 협업 의지가 없거나 여러가지 이슈때문에 협업이 가능하지 못할 경우 사용된다.

커뮤니케이션, 일반하위 도메인, 모델의 차이 등을 놓을수 있다. 