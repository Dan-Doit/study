name: Test CI-CD

on:
  push:
    tags:
      - "[0-9].[0-9]+.[0-9]+-md.[0-9]+"
      - "[0-9].[0-9]+.[0-9]+-ms.[0-9]+"
      - "[0-9].[0-9]+.[0-9]+-mp.[0-9]+"
      - "[0-9].[0-9]+.[0-9]+-sd.[0-9]+"
      - "[0-9].[0-9]+.[0-9]+-ss.[0-9]+"
      - "[0-9].[0-9]+.[0-9]+-sp.[0-9]+"
      - "[0-9].[0-9]+.[0-9]+-ad.[0-9]+"
      - "[0-9].[0-9]+.[0-9]+-as.[0-9]+"
      - "[0-9].[0-9]+.[0-9]+-ap.[0-9]+"

env:
  TARGET_ENVIRONMENT: ${{ github.ref }}

jobs:
  test:
    name: Test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Test
        run: |
          TAG=${GITHUB_REF#refs/tags/}
          TAG=${TAG##*-}
          TAG=${TAG%%.*}
          
          if [ ${SERVICE:0:1} == 'm' ]; then echo "SERVICE=market" >> $GITHUB_ENV; fi
          if [ ${SERVICE:1:1} == 'd' ]; then echo "REPO=development" >> $GITHUB_ENV; fi

      - name: Echo SERVICE
        run: echo "${{env.SERVICE}}"
