name: Test CI-CD

on:
  push:
    tags:
      - "admin.development-[0-9].[0-9]+.[0-9]+"
      - "admin.stage-[0-9].[0-9]+.[0-9]+"
      - "admin.master-[0-9].[0-9]+.[0-9]+"
      - "market.development-[0-9].[0-9]+.[0-9]+"
      - "market.stage-[0-9].[0-9]+.[0-9]+"
      - "market.master-[0-9].[0-9]+.[0-9]+"
      - "store.development-[0-9].[0-9]+.[0-9]+"
      - "store.stage-[0-9].[0-9]+.[0-9]+"
      - "store.master-[0-9].[0-9]+.[0-9]+"

env:
  TARGET_ENVIRONMENT: ${{ github.ref == 'refs/heads/feature' && 'feature' || github.ref == 'refs/heads/main' && 'main' }}

jobs:
  test:
    name: Test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Tag Releases
        run: |
          TAG=${{ github.event.release.tag_name }}
          echo "::debug::${GITHUB_REF#refs/tags/}"
          echo "::debug::${TAG#admin.}"
          echo "VERSION=${TAG#v}" >> $GITHUB_ENV
