# 2장

---

리팩터링은 전과 후의 코드가 똑같이 동작을 해야한다는 뜻이다.



## 리팩터링을 하는 이유

- 소프트웨어 설계가 좋아진다.
- 소프트웨어를 이해하기 쉬워진다.
- 버그를 쉽게 찾을 수 있다.
- 프로그래밍 속도를 높일 수 있다.

> ### 화자가 말하는 지구력 가설이란?
>
> - 내부 설계가 잘 된 소프트웨어는 새로운 기능을 추가할 지점과 어떻게 고칠지 쉽게 찾을수 있다.
> - 코드가 명확하기에 버그를 만들 가능성도 줄고, 버그가 있더라도 디버깅 하기 훨씬 쉽다.



## 두개의 모자

- 기능추가
  - 기존 코드는 절대 건드리지 않고 새 기능을 추가한다.
- 리팩터링
  - 기능 추가는 절대 하지않고 오로지 코드 재구성에만 전념한다.
  - 앞 과정에서 놓친 테스트 케이스를 발견할 경우에만 추가한다.



## 언제 리팩터링 하는가

- 처음에는 그냥한다.
- 비슷한 일을 두번째로 하게 되면, 일단 진행한다.
- 비슷한 일을 세번째로 하게 되면 리팩터링한다.



## 리팩터링의 목적

어떠한 목적을 두고 하는 리팩터링이냐에 따라 다른 구현이 나온다.

- 준비를 위한 리팩터링 : 기능을 쉽게 추가하기 위해

  - 함수 매개 변수화 하기
  - 중복되는 함수를 합치면 하나의 함수 안에서 여러 에러를 한번에 해결 할 수 있다.

  

- 이해를 위한 리팩터링 : 코드를 쉽게 이해하기 위해

  - 다른 사람을 위해 코드를 만들때는 코드가 명확해야 한다.
  - 리팩터링을 하면 코드에 옮겨 담을 수 있다.

  

- 효율을 위한 리팩터링 : 쓰레기를 줍기 위해

  - 로직이 쓸대없이 복잡하다면
  - 똑같은 함수가 여러개가 반복된다면
  - 간단히 수정 할 수 있는건 즉시 고친다.
  - 시간이 걸리는 건 메모를 남긴다.
  - 한순간도 코드가 깨지는걸 최대한 막아야한다.

  

- 계획한 리팩터링 : 코드와의 타협을 위해
  - 앞에있는 리팩터링은 기회가 있을때 실행을 한다.
  - 그동안 리팩터링에 소홀했다면 따로 시간을 내서 진행할 필요가 있다.
  - 계획된 리팩터링이 많을수록 범위가 커지고 많은 자원을 쓰게된다.
  - 앞서 말했듯이 기회가 있을때마다 리팩토링에 대해 신경을 많이 쓰자.



- 오래 걸리는 리팩터링 : 대규모 리팩터링을 위해
  - 팀 전제가 달려들어도 몇주가 걸리는 대규모 리팩터링이 있다.
  - 이런경우 주어진 문제를 몇주에 걸쳐 조금씩 해결하는게 효과적이다.
  - 누구든지 리팩터링 해야 할 코드와 관련 작업을 할경우 원하는 방향으로 조금씩 개선을한다.
  - 이 전략을 **추상화로 갈아타기** 라고 부른다.



- 코드 리뷰와 리팩터링 : 더 넓은 시각을 위해
  - 코드리뷰를 정기적으로 수행하면 좋다.
  - 개발팀 전체에 지식을 전파하여준다.
  - 다른 사람의 아이디어를 얻을 수있는 장점이 있다.



- 관리자의 허락 받기 : 더 나은 방향을 위해
  - 개발자는 프로다.
  - 프로는 누구보다 효율적으로 일하고, 효과적으로 만든다.
  - 리팩터링은 빠르게 구현하고, 효과적이다.
  - 고로 고민할 필요가없다 설득하라.



- 리팩터링 하지 말하야할 때 : 굳이 하지 않아도 될 작업을 위해
  - 지저분한 코드를 봐도 수정 할 필요가  없을 경우 리팩터링을 하지 않는다.
  - 외부 API를 가져다 쓰는 경우 리팩터링을 하지 않는다.
  - 리팩터링을 하는것보다 새로 작성하는 게 쉬울때 리팩터링을 하지 않는다.
- 
